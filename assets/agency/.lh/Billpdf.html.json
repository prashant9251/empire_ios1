{
    "sourceFile": "Billpdf.html",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 8,
            "patches": [
                {
                    "date": 1637547098627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1637547204980,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -145,19 +145,23 @@\n                 }\r\n               })\r\n             }\r\n \r\n-            if (IDE != '' && IDE != null) {\r\n+            if ((CNO != '' && CNO != null) && (TYPE != '' && TYPE != null) && (VNO != '' && VNO != null)) {\r\n               Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((billDetails) => billDetails['IDE'].toUpperCase() == IDE.toUpperCase());\r\n+                return data.billDetails.some((billDetails) => billDetails['CNO'].toUpperCase() == CNO.toUpperCase()\r\n+                  && billDetails['TYPE'].toUpperCase() == TYPE.toUpperCase()\r\n+                  && billDetails['VNO'].toUpperCase() == VNO.toUpperCase());\r\n               }).map(function (subdata) {\r\n                 return {\r\n                   COD: subdata.COD,\r\n                   ATP: subdata.ATP,\r\n                   CT: subdata.CT,\r\n                   CG: subdata.CG,\r\n                   billDetails: subdata.billDetails.filter(function (billDetails) {\r\n-                    return ((billDetails['IDE'].toUpperCase() == IDE.toUpperCase()));\r\n+                    return (billDetails['CNO'].toUpperCase() == CNO.toUpperCase()\r\n+                      && billDetails['TYPE'].toUpperCase() == TYPE.toUpperCase()\r\n+                      && billDetails['VNO'].toUpperCase() == VNO.toUpperCase());\r\n                   })\r\n                 }\r\n               })\r\n             }\r\n"
                },
                {
                    "date": 1637547245539,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,8 +77,11 @@\n   var fromdate = getUrlParams(url, \"search_FromDate\");\r\n   var todate = getUrlParams(url, \"search_ToDate\");\r\n   var CrntYearStartdate = getUrlParams(url, \"CrntYearStartdate\");\r\n   var pdfBillType = getUrlParams(url, \"pdfBillType\");\r\n+  var CNO = getUrlParams(url, \"CNO\");\r\n+  var TYPE = getUrlParams(url, \"TYPE\");\r\n+  var VNO = getUrlParams(url, \"VNO\");\r\n   if (pdfBillType == 'BULK') {\r\n     if (fromdate == '' || fromdate == null) {\r\n       if (CrntYearStartdate != '' || CrntYearStartdate != null) {\r\n         fromdate = CrntYearStartdate;\r\n"
                },
                {
                    "date": 1638352155608,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,8 +37,9 @@\n   var DSN = getUrlParams(url, \"DatabaseSource\");\r\n   var Crntyear = getUrlParams(url, \"Currentyear\");\r\n   var ClDb = DSN.replace(Crntyear, \"\");\r\n </script>\r\n+<script src=\"js/localStorageGet.js\"></script>\r\n <script src=\"js/jsGetObjectByKey.js\"></script>\r\n <script src=\"js/jsfunction.js\"></script>\r\n <script src=\"js/jstoFixed.js\"></script>\r\n <script src=\"js/jstoFixedNumber.js\"></script>\r\n"
                },
                {
                    "date": 1638352174546,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,8 @@\n <script>\r\n   var url = window.location.href;\r\n   var DSN = getUrlParams(url, \"DatabaseSource\");\r\n   var Crntyear = getUrlParams(url, \"Currentyear\");\r\n-  var ClDb = DSN.replace(Crntyear, \"\");\r\n </script>\r\n <script src=\"js/localStorageGet.js\"></script>\r\n <script src=\"js/jsGetObjectByKey.js\"></script>\r\n <script src=\"js/jsfunction.js\"></script>\r\n"
                },
                {
                    "date": 1639728051880,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,8 +108,11 @@\n         jsGetObjectByKey(yearChangeDSN, \"MST\", \"\").then(function (data) {\r\n           masterData = data;\r\n           jsGetObjectByKey(yearChangeDSN, \"BLS\", \"\").then(function (dataBLS) {\r\n             Data = dataBLS;\r\n+            Data = Data.filter(function (d) {\r\n+              return d != null;\r\n+            })\r\n             // Data = Data.sort(function (a, b) {\r\n             //   if (a.code < b.code) {\r\n             //     return -1;\r\n             //   }\r\n"
                },
                {
                    "date": 1649653463504,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,158 +101,168 @@\n     } else {\r\n       yearChangeDSN = DSN;\r\n     }\r\n     try {\r\n-      jsGetObjectByKey(yearChangeDSN, \"SERIES\", \"\").then(function (data) {\r\n-        SERIESData = data;\r\n-        console.log(SERIESData);\r\n-        jsGetObjectByKey(yearChangeDSN, \"MST\", \"\").then(function (data) {\r\n-          masterData = data;\r\n-          jsGetObjectByKey(yearChangeDSN, \"BLS\", \"\").then(function (dataBLS) {\r\n-            Data = dataBLS;\r\n-            Data = Data.filter(function (d) {\r\n-              return d != null;\r\n-            })\r\n-            // Data = Data.sort(function (a, b) {\r\n-            //   if (a.code < b.code) {\r\n-            //     return -1;\r\n-            //   }\r\n-            //   if (a.code > b.code) {\r\n-            //     return 1;\r\n-            //   }\r\n-            //   return 0;\r\n-            // })\r\n-            console.log(IDE, Data);\r\n-\r\n-            if (pdfBillType == 'BULK') {\r\n-              Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((bill) => (bill['DT'] != null && bill['DT'] != \"\"));\r\n-              }).map(function (subdata) {\r\n-                return {\r\n-                  COD: subdata.COD,\r\n-                  ATP: subdata.ATP,\r\n-                  CT: subdata.CT,\r\n-                  CG: subdata.CG,\r\n-                  billDetails: subdata.billDetails.filter(function (bill) {\r\n-                    return (bill['DT'] != null && bill['DT'] != \"\");\r\n-                  })\r\n-                }\r\n-              })\r\n-              Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((bill) => (bill.DT.trim().toUpperCase().indexOf('OS') > -1));\r\n-              }).map(function (subdata) {\r\n-                return {\r\n-                  COD: subdata.COD,\r\n-                  ATP: subdata.ATP,\r\n-                  CT: subdata.CT,\r\n-                  CG: subdata.CG,\r\n-                  billDetails: subdata.billDetails.filter(function (bill) {\r\n-                    return (bill.DT.trim().toUpperCase().indexOf('OS') > -1);\r\n-                  })\r\n-                }\r\n-              })\r\n+      jsGetObjectByKey(DSN, \"COMPMST\", \"\").then(function (DD) {\r\n+        DataCompmst = DD;\r\n+        if (FIRM != '') {\r\n+          for (var i = 0; i < DataCompmst.length; i++) {\r\n+            if (DataCompmst[i].FIRM == FIRM) {\r\n+              cno = DataCompmst[i].CNO;\r\n             }\r\n-\r\n-            if ((CNO != '' && CNO != null) && (TYPE != '' && TYPE != null) && (VNO != '' && VNO != null)) {\r\n-              Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((billDetails) => billDetails['CNO'].toUpperCase() == CNO.toUpperCase()\r\n-                  && billDetails['TYPE'].toUpperCase() == TYPE.toUpperCase()\r\n-                  && billDetails['VNO'].toUpperCase() == VNO.toUpperCase());\r\n-              }).map(function (subdata) {\r\n-                return {\r\n-                  COD: subdata.COD,\r\n-                  ATP: subdata.ATP,\r\n-                  CT: subdata.CT,\r\n-                  CG: subdata.CG,\r\n-                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n-                    return (billDetails['CNO'].toUpperCase() == CNO.toUpperCase()\r\n-                      && billDetails['TYPE'].toUpperCase() == TYPE.toUpperCase()\r\n-                      && billDetails['VNO'].toUpperCase() == VNO.toUpperCase());\r\n-                  })\r\n-                }\r\n+          }\r\n+        }\r\n+        jsGetObjectByKey(yearChangeDSN, \"SERIES\", \"\").then(function (data) {\r\n+          SERIESData = data;\r\n+          console.log(SERIESData);\r\n+          jsGetObjectByKey(yearChangeDSN, \"MST\", \"\").then(function (data) {\r\n+            masterData = data;\r\n+            jsGetObjectByKey(yearChangeDSN, \"BLS\", \"\").then(function (dataBLS) {\r\n+              Data = dataBLS;\r\n+              Data = Data.filter(function (d) {\r\n+                return d != null;\r\n               })\r\n-            }\r\n-            // console.log(IDE, Data);\r\n-            if (this.cno != '' && this.cno != null) {\r\n-              Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((billDetails) => billDetails['CNO'] === this.cno);\r\n-              }).map(function (subdata) {\r\n-                return {\r\n-                  COD: subdata.COD,\r\n-                  ATP: subdata.ATP,\r\n-                  CT: subdata.CT,\r\n-                  CG: subdata.CG,\r\n-                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n-                    return (billDetails['CNO'] === this.cno);\r\n-                  })\r\n-                }\r\n-              })\r\n-            }\r\n-            console.log(Data);\r\n+              // Data = Data.sort(function (a, b) {\r\n+              //   if (a.code < b.code) {\r\n+              //     return -1;\r\n+              //   }\r\n+              //   if (a.code > b.code) {\r\n+              //     return 1;\r\n+              //   }\r\n+              //   return 0;\r\n+              // })\r\n+              console.log(IDE, Data);\r\n \r\n-            if (partycode != '' && partycode != null) {\r\n-              Data = Data.filter(function (data) {\r\n-                return data.COD == partycode;\r\n-              })\r\n-            }\r\n-            console.log(ccd, Data);\r\n-            if (ccd != '' && ccd != null) {\r\n-              Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((billDetails) => billDetails['ccd'] === ccd);\r\n-              }).map(function (subdata) {\r\n-                return {\r\n-                  COD: subdata.COD,\r\n-                  ATP: subdata.ATP,\r\n-                  CT: subdata.CT,\r\n-                  CG: subdata.CG,\r\n-                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n-                    return (billDetails['ccd'] === ccd);\r\n-                  })\r\n-                }\r\n-              })\r\n-            }\r\n-            console.log(ccd, Data);\r\n-            if (fromdate != '' && fromdate != null) {\r\n-              Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((billDetails) => new Date(billDetails.DTE) >= new Date(fromdate).setHours(0, 0, 0, 0));\r\n-              }).map(function (subdata) {\r\n-                return {\r\n-                  COD: subdata.COD,\r\n-                  ATP: subdata.ATP,\r\n-                  CT: subdata.CT,\r\n-                  CG: subdata.CG,\r\n-                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n-                    return new Date(billDetails.DTE) >= new Date(fromdate).setHours(0, 0, 0, 0);\r\n-                  })\r\n-                }\r\n-              })\r\n-            }\r\n-            console.log(fromdate, Data);\r\n+              if (pdfBillType == 'BULK') {\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.billDetails.some((bill) => (bill['DT'] != null && bill['DT'] != \"\"));\r\n+                }).map(function (subdata) {\r\n+                  return {\r\n+                    COD: subdata.COD,\r\n+                    ATP: subdata.ATP,\r\n+                    CT: subdata.CT,\r\n+                    CG: subdata.CG,\r\n+                    billDetails: subdata.billDetails.filter(function (bill) {\r\n+                      return (bill['DT'] != null && bill['DT'] != \"\");\r\n+                    })\r\n+                  }\r\n+                })\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.billDetails.some((bill) => (bill.DT.trim().toUpperCase().indexOf('OS') > -1));\r\n+                }).map(function (subdata) {\r\n+                  return {\r\n+                    COD: subdata.COD,\r\n+                    ATP: subdata.ATP,\r\n+                    CT: subdata.CT,\r\n+                    CG: subdata.CG,\r\n+                    billDetails: subdata.billDetails.filter(function (bill) {\r\n+                      return (bill.DT.trim().toUpperCase().indexOf('OS') > -1);\r\n+                    })\r\n+                  }\r\n+                })\r\n+              }\r\n \r\n-            if (todate != '' && todate != null) {\r\n-              Data = Data.filter(function (data) {\r\n-                return data.billDetails.some((billDetails) => new Date(billDetails.DTE) <= new Date(todate).setHours(24, 0, 0, 0));\r\n-              }).map(function (subdata) {\r\n-                return {\r\n-                  COD: subdata.COD,\r\n-                  ATP: subdata.ATP,\r\n-                  CT: subdata.CT,\r\n-                  CG: subdata.CG,\r\n-                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n-                    return new Date(billDetails.DTE) <= new Date(todate).setHours(24, 0, 0, 0);\r\n-                  })\r\n-                }\r\n-              })\r\n-            }\r\n-            console.log(todate, Data);\r\n-            BLS = Data;\r\n-            console.log(IDE, Data);\r\n+              if ((CNO != '' && CNO != null) && (TYPE != '' && TYPE != null) && (VNO != '' && VNO != null)) {\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.billDetails.some((billDetails) => billDetails['CNO'].toUpperCase() == CNO.toUpperCase()\r\n+                    && billDetails['TYPE'].toUpperCase() == TYPE.toUpperCase()\r\n+                    && billDetails['VNO'].toUpperCase() == VNO.toUpperCase());\r\n+                }).map(function (subdata) {\r\n+                  return {\r\n+                    COD: subdata.COD,\r\n+                    ATP: subdata.ATP,\r\n+                    CT: subdata.CT,\r\n+                    CG: subdata.CG,\r\n+                    billDetails: subdata.billDetails.filter(function (billDetails) {\r\n+                      return (billDetails['CNO'].toUpperCase() == CNO.toUpperCase()\r\n+                        && billDetails['TYPE'].toUpperCase() == TYPE.toUpperCase()\r\n+                        && billDetails['VNO'].toUpperCase() == VNO.toUpperCase());\r\n+                    })\r\n+                  }\r\n+                })\r\n+              }\r\n+              // console.log(IDE, Data);\r\n+              if (this.cno != '' && this.cno != null) {\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.billDetails.some((billDetails) => billDetails['CNO'] === this.cno);\r\n+                }).map(function (subdata) {\r\n+                  return {\r\n+                    COD: subdata.COD,\r\n+                    ATP: subdata.ATP,\r\n+                    CT: subdata.CT,\r\n+                    CG: subdata.CG,\r\n+                    billDetails: subdata.billDetails.filter(function (billDetails) {\r\n+                      return (billDetails['CNO'] === this.cno);\r\n+                    })\r\n+                  }\r\n+                })\r\n+              }\r\n+              console.log(Data);\r\n \r\n-            jsGetObjectByKey(yearChangeDSN, \"DET\", \"\").then(function (dataDET) {\r\n-              DETdata = dataDET;\r\n-              loadBillPdfCall();\r\n+              if (partycode != '' && partycode != null) {\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.COD == partycode;\r\n+                })\r\n+              }\r\n+              console.log(ccd, Data);\r\n+              if (ccd != '' && ccd != null) {\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.billDetails.some((billDetails) => billDetails['ccd'] === ccd);\r\n+                }).map(function (subdata) {\r\n+                  return {\r\n+                    COD: subdata.COD,\r\n+                    ATP: subdata.ATP,\r\n+                    CT: subdata.CT,\r\n+                    CG: subdata.CG,\r\n+                    billDetails: subdata.billDetails.filter(function (billDetails) {\r\n+                      return (billDetails['ccd'] === ccd);\r\n+                    })\r\n+                  }\r\n+                })\r\n+              }\r\n+              console.log(ccd, Data);\r\n+              if (fromdate != '' && fromdate != null) {\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.billDetails.some((billDetails) => new Date(billDetails.DTE) >= new Date(fromdate).setHours(0, 0, 0, 0));\r\n+                }).map(function (subdata) {\r\n+                  return {\r\n+                    COD: subdata.COD,\r\n+                    ATP: subdata.ATP,\r\n+                    CT: subdata.CT,\r\n+                    CG: subdata.CG,\r\n+                    billDetails: subdata.billDetails.filter(function (billDetails) {\r\n+                      return new Date(billDetails.DTE) >= new Date(fromdate).setHours(0, 0, 0, 0);\r\n+                    })\r\n+                  }\r\n+                })\r\n+              }\r\n+              console.log(fromdate, Data);\r\n+\r\n+              if (todate != '' && todate != null) {\r\n+                Data = Data.filter(function (data) {\r\n+                  return data.billDetails.some((billDetails) => new Date(billDetails.DTE) <= new Date(todate).setHours(24, 0, 0, 0));\r\n+                }).map(function (subdata) {\r\n+                  return {\r\n+                    COD: subdata.COD,\r\n+                    ATP: subdata.ATP,\r\n+                    CT: subdata.CT,\r\n+                    CG: subdata.CG,\r\n+                    billDetails: subdata.billDetails.filter(function (billDetails) {\r\n+                      return new Date(billDetails.DTE) <= new Date(todate).setHours(24, 0, 0, 0);\r\n+                    })\r\n+                  }\r\n+                })\r\n+              }\r\n+              console.log(todate, Data);\r\n+              BLS = Data;\r\n+              console.log(IDE, Data);\r\n+\r\n+              jsGetObjectByKey(yearChangeDSN, \"DET\", \"\").then(function (dataDET) {\r\n+                DETdata = dataDET;\r\n+                loadBillPdfCall();\r\n+              });\r\n             });\r\n-          });\r\n+          })\r\n         })\r\n       })\r\n     } catch (error) {\r\n       noteError(error);\r\n"
                },
                {
                    "date": 1649653480418,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,16 +54,10 @@\n   var YearChange = (getUrlParams(url, \"YearChange\"));\r\n   var CrntyearSelectYear;\r\n   var FIRM = (getUrlParams(url, \"FIRM\"));\r\n   var cno = '';\r\n-  DataCompmst = JSON.parse(localStorage.getItem(\"COMPMST\"));\r\n-  if (FIRM != '') {\r\n-    for (var i = 0; i < DataCompmst.length; i++) {\r\n-      if (DataCompmst[i].FIRM == FIRM) {\r\n-        cno = DataCompmst[i].CNO;\r\n-      }\r\n-    }\r\n-  }\r\n+  DataCompmst = [];\r\n+ \r\n \r\n   var Data;\r\n   var partyname = getUrlParams(url, \"partyname\");\r\n   var partycode = (getUrlParams(url, \"partycode\"));\r\n"
                },
                {
                    "date": 1649653487741,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,10 +55,8 @@\n   var CrntyearSelectYear;\r\n   var FIRM = (getUrlParams(url, \"FIRM\"));\r\n   var cno = '';\r\n   DataCompmst = [];\r\n- \r\n-\r\n   var Data;\r\n   var partyname = getUrlParams(url, \"partyname\");\r\n   var partycode = (getUrlParams(url, \"partycode\"));\r\n   var ccd = getUrlParams(url, \"ccd\");\r\n"
                }
            ],
            "date": 1637547098627,
            "name": "Commit-0",
            "content": "<html>\r\n\r\n<head>\r\n\r\n  <title>BILL</title>\r\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"css/billPdf.css\">\r\n  <script src=\"3.3.1/jquery.min.js\"></script>\r\n  <script src=\"3.3.7/bootstrap.min.js\"></script>\r\n  <script src=\"js/jsGetUrlParams.js\"></script>\r\n  <style>\r\n    .hcategory {\r\n      display: none;\r\n    }\r\n\r\n    .hNetMts {\r\n      display: none;\r\n    }\r\n\r\n    .hLessFold {\r\n      display: none;\r\n    }\r\n\r\n    .hDiscRate {\r\n      display: none;\r\n    }\r\n  </style>\r\n</head>\r\n\r\n<body style=\"font-family: serif;\">\r\n  <div style=\"display: none;\" id=\"loader\">\r\n    <div class=\"loader\"></div>\r\n    <div style=\"text-align: center; margin-top: -80px; font-weight:700\">Please wait...</div>\r\n  </div>\r\n</body>\r\n<script>\r\n  var url = window.location.href;\r\n  var DSN = getUrlParams(url, \"DatabaseSource\");\r\n  var Crntyear = getUrlParams(url, \"Currentyear\");\r\n  var ClDb = DSN.replace(Crntyear, \"\");\r\n</script>\r\n<script src=\"js/jsGetObjectByKey.js\"></script>\r\n<script src=\"js/jsfunction.js\"></script>\r\n<script src=\"js/jstoFixed.js\"></script>\r\n<script src=\"js/jstoFixedNumber.js\"></script>\r\n<script src=\"js/jsGetDateFormate.js\"></script>\r\n<script src=\"js/jsGetDaysDif.js\"></script>\r\n<script src=\"js/jsgetValueNotDefine.js\"></script>\r\n<script src=\"js/jsgetValueNotDefineNo.js\"></script>\r\n<script src=\"js/jsGetYearChange.js\"></script>\r\n<script src=\"js/creditDebitBill.js\"></script>\r\n<script>\r\n  var IDE = (getUrlParams(url, \"IDE\"));\r\n  var VNO = (getUrlParams(url, \"VNO\"));\r\n  var YearChange = (getUrlParams(url, \"YearChange\"));\r\n  var CrntyearSelectYear;\r\n  var FIRM = (getUrlParams(url, \"FIRM\"));\r\n  var cno = '';\r\n  DataCompmst = JSON.parse(localStorage.getItem(\"COMPMST\"));\r\n  if (FIRM != '') {\r\n    for (var i = 0; i < DataCompmst.length; i++) {\r\n      if (DataCompmst[i].FIRM == FIRM) {\r\n        cno = DataCompmst[i].CNO;\r\n      }\r\n    }\r\n  }\r\n\r\n  var Data;\r\n  var partyname = getUrlParams(url, \"partyname\");\r\n  var partycode = (getUrlParams(url, \"partycode\"));\r\n  var ccd = getUrlParams(url, \"ccd\");\r\n  if (partyname == '') {\r\n    partycode = '';\r\n  }\r\n  var broker = getUrlParams(url, \"broker\");\r\n  var haste = getUrlParams(url, \"haste\");\r\n  var CITY = getUrlParams(url, \"city\");\r\n  var fromdate = getUrlParams(url, \"search_FromDate\");\r\n  var todate = getUrlParams(url, \"search_ToDate\");\r\n  var CrntYearStartdate = getUrlParams(url, \"CrntYearStartdate\");\r\n  var pdfBillType = getUrlParams(url, \"pdfBillType\");\r\n  if (pdfBillType == 'BULK') {\r\n    if (fromdate == '' || fromdate == null) {\r\n      if (CrntYearStartdate != '' || CrntYearStartdate != null) {\r\n        fromdate = CrntYearStartdate;\r\n      }\r\n    }\r\n  }\r\n  $(document).ready(function () {\r\n    $(\"#loader\").addClass('has-loader');\r\n    load_data();\r\n  });\r\n  var SERIESData;\r\n\r\n  function load_data() {\r\n\r\n    if (YearChange != '' && YearChange != null) {\r\n      yearChangeDSN = ClDb + YearChange;\r\n    } else {\r\n      yearChangeDSN = DSN;\r\n    }\r\n    try {\r\n      jsGetObjectByKey(yearChangeDSN, \"SERIES\", \"\").then(function (data) {\r\n        SERIESData = data;\r\n        console.log(SERIESData);\r\n        jsGetObjectByKey(yearChangeDSN, \"MST\", \"\").then(function (data) {\r\n          masterData = data;\r\n          jsGetObjectByKey(yearChangeDSN, \"BLS\", \"\").then(function (dataBLS) {\r\n            Data = dataBLS;\r\n            // Data = Data.sort(function (a, b) {\r\n            //   if (a.code < b.code) {\r\n            //     return -1;\r\n            //   }\r\n            //   if (a.code > b.code) {\r\n            //     return 1;\r\n            //   }\r\n            //   return 0;\r\n            // })\r\n            console.log(IDE, Data);\r\n\r\n            if (pdfBillType == 'BULK') {\r\n              Data = Data.filter(function (data) {\r\n                return data.billDetails.some((bill) => (bill['DT'] != null && bill['DT'] != \"\"));\r\n              }).map(function (subdata) {\r\n                return {\r\n                  COD: subdata.COD,\r\n                  ATP: subdata.ATP,\r\n                  CT: subdata.CT,\r\n                  CG: subdata.CG,\r\n                  billDetails: subdata.billDetails.filter(function (bill) {\r\n                    return (bill['DT'] != null && bill['DT'] != \"\");\r\n                  })\r\n                }\r\n              })\r\n              Data = Data.filter(function (data) {\r\n                return data.billDetails.some((bill) => (bill.DT.trim().toUpperCase().indexOf('OS') > -1));\r\n              }).map(function (subdata) {\r\n                return {\r\n                  COD: subdata.COD,\r\n                  ATP: subdata.ATP,\r\n                  CT: subdata.CT,\r\n                  CG: subdata.CG,\r\n                  billDetails: subdata.billDetails.filter(function (bill) {\r\n                    return (bill.DT.trim().toUpperCase().indexOf('OS') > -1);\r\n                  })\r\n                }\r\n              })\r\n            }\r\n\r\n            if (IDE != '' && IDE != null) {\r\n              Data = Data.filter(function (data) {\r\n                return data.billDetails.some((billDetails) => billDetails['IDE'].toUpperCase() == IDE.toUpperCase());\r\n              }).map(function (subdata) {\r\n                return {\r\n                  COD: subdata.COD,\r\n                  ATP: subdata.ATP,\r\n                  CT: subdata.CT,\r\n                  CG: subdata.CG,\r\n                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n                    return ((billDetails['IDE'].toUpperCase() == IDE.toUpperCase()));\r\n                  })\r\n                }\r\n              })\r\n            }\r\n            // console.log(IDE, Data);\r\n            if (this.cno != '' && this.cno != null) {\r\n              Data = Data.filter(function (data) {\r\n                return data.billDetails.some((billDetails) => billDetails['CNO'] === this.cno);\r\n              }).map(function (subdata) {\r\n                return {\r\n                  COD: subdata.COD,\r\n                  ATP: subdata.ATP,\r\n                  CT: subdata.CT,\r\n                  CG: subdata.CG,\r\n                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n                    return (billDetails['CNO'] === this.cno);\r\n                  })\r\n                }\r\n              })\r\n            }\r\n            console.log(Data);\r\n\r\n            if (partycode != '' && partycode != null) {\r\n              Data = Data.filter(function (data) {\r\n                return data.COD == partycode;\r\n              })\r\n            }\r\n            console.log(ccd, Data);\r\n            if (ccd != '' && ccd != null) {\r\n              Data = Data.filter(function (data) {\r\n                return data.billDetails.some((billDetails) => billDetails['ccd'] === ccd);\r\n              }).map(function (subdata) {\r\n                return {\r\n                  COD: subdata.COD,\r\n                  ATP: subdata.ATP,\r\n                  CT: subdata.CT,\r\n                  CG: subdata.CG,\r\n                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n                    return (billDetails['ccd'] === ccd);\r\n                  })\r\n                }\r\n              })\r\n            }\r\n            console.log(ccd, Data);\r\n            if (fromdate != '' && fromdate != null) {\r\n              Data = Data.filter(function (data) {\r\n                return data.billDetails.some((billDetails) => new Date(billDetails.DTE) >= new Date(fromdate).setHours(0, 0, 0, 0));\r\n              }).map(function (subdata) {\r\n                return {\r\n                  COD: subdata.COD,\r\n                  ATP: subdata.ATP,\r\n                  CT: subdata.CT,\r\n                  CG: subdata.CG,\r\n                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n                    return new Date(billDetails.DTE) >= new Date(fromdate).setHours(0, 0, 0, 0);\r\n                  })\r\n                }\r\n              })\r\n            }\r\n            console.log(fromdate, Data);\r\n\r\n            if (todate != '' && todate != null) {\r\n              Data = Data.filter(function (data) {\r\n                return data.billDetails.some((billDetails) => new Date(billDetails.DTE) <= new Date(todate).setHours(24, 0, 0, 0));\r\n              }).map(function (subdata) {\r\n                return {\r\n                  COD: subdata.COD,\r\n                  ATP: subdata.ATP,\r\n                  CT: subdata.CT,\r\n                  CG: subdata.CG,\r\n                  billDetails: subdata.billDetails.filter(function (billDetails) {\r\n                    return new Date(billDetails.DTE) <= new Date(todate).setHours(24, 0, 0, 0);\r\n                  })\r\n                }\r\n              })\r\n            }\r\n            console.log(todate, Data);\r\n            BLS = Data;\r\n            console.log(IDE, Data);\r\n\r\n            jsGetObjectByKey(yearChangeDSN, \"DET\", \"\").then(function (dataDET) {\r\n              DETdata = dataDET;\r\n              loadBillPdfCall();\r\n            });\r\n          });\r\n        })\r\n      })\r\n    } catch (error) {\r\n      noteError(error);\r\n    }\r\n  }\r\n</script>"
        }
    ]
}