{
    "sourceFile": "DDREG_AJXREPORT.html",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1638352536708,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1649653675297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,9 +107,9 @@\n       // }\r\n \r\n       if (partyname != '' && partyname != null) {\r\n         Data = Data.filter(function (data) {\r\n-          return data.billDetails.some((billDetails) => billDetails['ccd'] ==partyname);\r\n+          return data.billDetails.some((billDetails) => billDetails['ccd'] == partyname);\r\n         }).map(function (subdata) {\r\n           return {\r\n             COD: subdata.COD,\r\n             ATP: subdata.ATP,\r\n@@ -410,13 +410,23 @@\n     load_data();\r\n   });\r\n \r\n   function load_data() {\r\n-    jsGetObjectByKey(DSN, \"MST\", \"\").then(function (data) {\r\n-      masterData = data;\r\n-      jsGetObjectByKey(DSN, \"COMM\", \"\").then(function (data) {\r\n-        Data = data;\r\n-        loadCall(Data);\r\n+    jsGetObjectByKey(DSN, \"COMPMST\", \"\").then(function (DD) {\r\n+      DataCompmst = DD;\r\n+      if (FIRM != '') {\r\n+        for (var i = 0; i < DataCompmst.length; i++) {\r\n+          if (DataCompmst[i].FIRM == FIRM) {\r\n+            cno = DataCompmst[i].CNO;\r\n+          }\r\n+        }\r\n+      }\r\n+      jsGetObjectByKey(DSN, \"MST\", \"\").then(function (data) {\r\n+        masterData = data;\r\n+        jsGetObjectByKey(DSN, \"COMM\", \"\").then(function (data) {\r\n+          Data = data;\r\n+          loadCall(Data);\r\n+        });\r\n       });\r\n     })\r\n   }\r\n \r\n"
                },
                {
                    "date": 1649653685262,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -392,17 +392,11 @@\n   var fromdate = getUrlParams(url, \"search_FromDate\");\r\n   var todate = getUrlParams(url, \"search_ToDate\");\r\n   var DAYSCONDITION = getUrlParams(url, \"DAYSCONDITION\");\r\n   GRD = getUrlParams(url, \"GRD\");\r\n-  var DataCompmst = JSON.parse(localStorage.getItem(\"COMPMST\"));\r\n+  var DataCompmst =[];\r\n   var nowDate = new Date();\r\n   if (FIRM != '') {\r\n-    for (var i = 0; i < DataCompmst.length; i++) {\r\n-      if (DataCompmst[i].FIRM == FIRM) {\r\n-        cno = DataCompmst[i].CNO;\r\n-      }\r\n-    }\r\n-  }\r\n </script>\r\n <script>\r\n   document.title = \"COMM. REPORT \" + partyname + \" \" + broker + \" \" + CITY;\r\n   $(document).ready(function () {\r\n"
                },
                {
                    "date": 1649653690517,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -393,10 +393,9 @@\n   var todate = getUrlParams(url, \"search_ToDate\");\r\n   var DAYSCONDITION = getUrlParams(url, \"DAYSCONDITION\");\r\n   GRD = getUrlParams(url, \"GRD\");\r\n   var DataCompmst =[];\r\n-  var nowDate = new Date();\r\n-  if (FIRM != '') {\r\n+  var nowDate = new Date();  \r\n </script>\r\n <script>\r\n   document.title = \"COMM. REPORT \" + partyname + \" \" + broker + \" \" + CITY;\r\n   $(document).ready(function () {\r\n"
                }
            ],
            "date": 1638352536708,
            "name": "Commit-0",
            "content": "<html>\r\n\r\n<head>\r\n  <title> OUTSTANDING </title>\r\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"css/style.css\">\r\n  <link href=\"4.1.1/bootstrap.min.css\" rel=\"stylesheet\" id=\"bootstrap-css\">\r\n  <link href=\"1.10.4/jquery-ui.css\" rel=\"stylesheet\">\r\n  <script src=\"1.10.2/jquery.js\"></script>\r\n  <script src=\"1.10.4/jquery-ui.js\"></script>\r\n  <script src=\"js/jsGetUrlParams.js\"></script>\r\n\r\n</head>\r\n<Style>\r\n\r\n</Style>\r\n\r\n<body>\r\n  <div align=\"center\" class=\"table-responsive\">\r\n    <table id=\"result\" class=\"content-table\">\r\n    </table>\r\n  </div>\r\n\r\n\r\n  <div style=\"display: none;\" id=\"loader\">\r\n    <div class=\"loader\"></div>\r\n    <div style=\"text-align: center; margin-top: -80px; font-weight:700\">Please wait...</div>\r\n  </div>\r\n</body>\r\n\r\n</html>\r\n<script>\r\n  var url = window.location.href;\r\n  var DSN = getUrlParams(url, \"DatabaseSource\");\r\n</script>\r\n<script src=\"js/localStorageGet.js\"></script>\r\n<script src=\"js/jsopenSubReportCOMM.js\"></script>\r\n<script src=\"js/jsGetUrlParams.js\"></script>\r\n<script src=\"js/jsGetYearChange.js\"></script>\r\n<script src=\"js/jsGetDaysDif.js\"></script>\r\n<script src=\"js/jsGetDateFormate.js\"></script>\r\n<script src=\"js/jsGetObjectByKey.js\"></script>\r\n<script src=\"js/jstoFixed.js\"></script>\r\n<script src=\"js/jsfunction.js\"></script>\r\n<script>\r\n\r\n  var ReportType = getUrlParams(url, \"ReportType\");\r\n  var ReportSeriesTypeCode = getUrlParams(url, \"ReportSeriesTypeCode\");\r\n  var ReportATypeCode = getUrlParams(url, \"ReportATypeCode\");\r\n  var ReportDOC_TYPECode = getUrlParams(url, \"ReportDOC_TYPECode\");\r\n  var GRD;\r\n\r\n  function loadCall(Data) {\r\n    try {\r\n\r\n      Data = Data;\r\n\r\n\r\n      if (ReportATypeCode != \"\" && ReportATypeCode != null && ReportATypeCode != undefined) {\r\n        Data = Data.filter(function (data) {\r\n          return data['ATP'] == ReportATypeCode;\r\n        })\r\n      }\r\n\r\n      if (cno != '' && cno != null) {\r\n        Data = Data.filter(function (data) {\r\n          return data.billDetails.some((billDetails) => billDetails['CNO'] === cno);\r\n        }).map(function (subdata) {\r\n          return {\r\n            COD: subdata.COD,\r\n            ATP: subdata.ATP,\r\n            billDetails: subdata.billDetails.filter(function (billDetails) {\r\n              return (billDetails['CNO'] === cno);\r\n            })\r\n          }\r\n        })\r\n      }\r\n      if (ccdcode != '' && ccdcode != null) {\r\n        Data = Data.filter(function (data) {\r\n          return data['COD'] == ccdcode;\r\n        })\r\n      }\r\n      //  \r\n      // if (this.broker != '' && this.broker != null) {\r\n      //   Data = Data.filter(function (data) {\r\n      //     return data.billDetails.some((billDetails) => billDetails['BCODE'] === this.broker);\r\n      //   }).map(function (subdata) {\r\n      //     return {\r\n      //       code: subdata.COD,\r\n      //       billDetails: subdata.billDetails.filter(function (billDetails) {\r\n      //         return (billDetails['BCODE'] === this.broker);\r\n      //       })\r\n      //     }\r\n      //   })\r\n      // }\r\n      //  \r\n      // if (CITY != '' && CITY != null) {\r\n      //   Data = Data.filter(function (data) {\r\n      //     return data.billDetails.some((billDetails) => billDetails['CITY'] == this.CITY);\r\n      //   }).map(function (subdata) {\r\n      //     return {\r\n      //       code: subdata.COD,\r\n      //       billDetails: subdata.billDetails.filter(function (billDetails) {\r\n      //         return (billDetails['CITY'] == this.CITY);\r\n      //       })\r\n      //     }\r\n      //   })\r\n      // }\r\n\r\n      if (partyname != '' && partyname != null) {\r\n        Data = Data.filter(function (data) {\r\n          return data.billDetails.some((billDetails) => billDetails['ccd'] ==partyname);\r\n        }).map(function (subdata) {\r\n          return {\r\n            COD: subdata.COD,\r\n            ATP: subdata.ATP,\r\n            billDetails: subdata.billDetails.filter(function (billDetails) {\r\n              return (billDetails['ccd'] == partyname);\r\n            })\r\n          }\r\n        })\r\n      }\r\n      if (fromdate !== '' && fromdate !== null) {\r\n        Data = Data.filter(function (data) {\r\n          return data.billDetails.some((billDetails) => new Date(billDetails.RDT).setHours(0, 0, 0, 0) >= new Date(fromdate).setHours(0, 0, 0, 0));\r\n        }).map(function (subdata) {\r\n          return {\r\n            COD: subdata.COD,\r\n            ATP: subdata.ATP,\r\n            billDetails: subdata.billDetails.filter(function (billDetails) {\r\n              return new Date(billDetails.RDT).setHours(0, 0, 0, 0) >= new Date(fromdate).setHours(0, 0, 0, 0);\r\n            })\r\n          }\r\n        })\r\n      }\r\n      if (todate !== '' && todate !== null) {\r\n        Data = Data.filter(function (data) {\r\n          return data.billDetails.some((billDetails) => new Date(billDetails.RDT).setHours(24, 0, 0, 0) <= new Date(todate).setHours(24, 0, 0, 0));\r\n        }).map(function (subdata) {\r\n          return {\r\n            COD: subdata.COD,\r\n            ATP: subdata.ATP,\r\n            billDetails: subdata.billDetails.filter(function (billDetails) {\r\n              return new Date(billDetails.RDT).setHours(24, 0, 0, 0) <= new Date(todate).setHours(24, 0, 0, 0);\r\n            })\r\n          }\r\n        })\r\n      }\r\n\r\n\r\n\r\n\r\n      var ccode;\r\n      var pcode;\r\n      var city;\r\n      var broker;\r\n      var label;\r\n      var grandtotalPDA = 0;\r\n      var grandtotalBA = 0;\r\n      var grandtotalCL = 0;\r\n      var grandtotalCMA = 0;\r\n      var totalPDA = 0;\r\n      var totalBA = 0;\r\n      var totalCL = 0;\r\n      var totalCMA = 0;\r\n      var subtotalPDA = 0;\r\n      var subtotalBA = 0;\r\n      var subtotalCL = 0;\r\n      var subtotalCMA = 0;\r\n      var BLL;\r\n      var FdataUrl\r\n      var DL = Data.length;\r\n      if (DL > 0) {\r\n        grandtotalPDA = 0;\r\n        grandtotalBA = 0;\r\n        grandtotalCL = 0;\r\n        grandtotalCMA = 0;\r\n        tr = \"<tbody>\";\r\n\r\n        for (var i = 0; i < DL; i++) {\r\n          ccode = getPartyDetailsBySendCode(Data[i].COD);\r\n\r\n          if (ccode.length > 0) {\r\n            label = getValueNotDefine(ccode[0].label);\r\n            pcode = getValueNotDefine(ccode[0].partyname);\r\n            city = getValueNotDefine(ccode[0].city);\r\n            CODE = getValueNotDefine(ccode[0].value);\r\n            broker = getValueNotDefine(ccode[0].broker);\r\n            MO = getValueNotDefine(ccode[0].MO);\r\n            ATYPE = getValueNotDefine(ccode[0].ATYPE);\r\n            lbl = parseInt(ATYPE) == 1 ? \"CUST : \" : parseInt(ATYPE) == 2 ? \"SUPP : \" : \"\";\r\n\r\n          }\r\n          tr += `<tr class=\"trPartyHead\"onclick=\"trOnClick('` + Data[i].COD + `','` + city + `','` + broker + `');\">\r\n                          <th colspan=\"17\" class=\"trPartyHead\">` + lbl + (label) + `<a href=\"tel:` + MO + `\"><button>MO:` + MO + `</button></a></th>\r\n                        </tr>\r\n                        `;\r\n\r\n          BLL = Data[i].billDetails.length;\r\n          if (BLL > 0) {\r\n            totalPDA = 0;\r\n            totalBA = 0;\r\n            totalCL = 0;\r\n            totalCMA = 0;\r\n            var codex = null;\r\n            var CodePrev = null;\r\n            for (j = 0; j < BLL; j++) {\r\n              var sr = 0\r\n              codex = Data[i].billDetails[j].ccd;\r\n              if (j == 0 && codex != CodePrev) {\r\n                tr += ` <tr style=\"font-weight:500;font-weight:bold;\"align=\"center\">                    \r\n            <td>CUSTOMER</td>\r\n            <td>BILL</td>\r\n            <td>VNO</td>\r\n            <td>DATE</td>\r\n            <td>CHQ.NO.</td>\r\n            <td>PAY DATE</td>\r\n            <td>PAY(DRAF)</td>\r\n            <td>GROSS<BR>AMT.</td>\r\n            <td>GOODS RET.</td>\r\n            <td>DD DATE</td>\r\n            <td>COMM AMT.</td>\r\n            </tr>  `;\r\n                CodePrev = codex;\r\n              }\r\n\r\n              if (j != 0 && codex != CodePrev) {\r\n\r\n                tr += `  \r\n            <tr class=\"tfootcard\"style=\"background-color:#3e3b3b26;color:#c107a2;text-align: center;\">\r\n            <td class=\"hideAbleTr\" colspan=\"6\">SUBTOTAL</td>\r\n            <td class=\"unhideAbleTr\" colspan=\"6\"onclick=\"openSubR('`+ Data[i].COD + `','` + Data[i].billDetails[j - 1].ccd + `')\">` + Data[i].billDetails[j - 1].ccd + `</td>\r\n            <td>`+ subtotalPDA + `</td>\r\n            <td>`+ subtotalBA + `</td>\r\n            <td>`+ subtotalCL + `</td>\r\n            <td colspan=\"1\"></td>\r\n            <td>`+ subtotalCMA + `</td>\r\n            </tr>  `;\r\n\r\n                totalPDA += subtotalPDA;\r\n                totalBA += subtotalBA;\r\n                totalCL += subtotalCL;\r\n                totalCMA += subtotalCMA;\r\n                totalCMA += subtotalCMA;\r\n                subtotalPDA = 0;\r\n                subtotalBA = 0;\r\n                subtotalCL = 0;\r\n                subtotalCMA = 0;\r\n                CodePrev = codex;\r\n\r\n              }\r\n\r\n              PDA = 0;\r\n              BA = 0;\r\n              CL = 0;\r\n              CMA = 0;\r\n              PDA = parseFloat((Data[i].billDetails[j].PDA == null) ? 0 : Data[i].billDetails[j].PDA);\r\n              BA = parseFloat((Data[i].billDetails[j].BA == null) ? 0 : Data[i].billDetails[j].BA);\r\n              CL = parseFloat((Data[i].billDetails[j].CL == null) ? 0 : Data[i].billDetails[j].CL);\r\n              CMA = parseFloat((Data[i].billDetails[j].CMA == null) ? 0 : Data[i].billDetails[j].CMA);\r\n              subtotalPDA += PDA;\r\n              subtotalBA += BA;\r\n              subtotalCL += CL;\r\n              subtotalCMA += CMA;\r\n\r\n              tr += ` \r\n                              \r\n                                <tr class=\"hideAbleTr\"align=\"center\"style=\"\">\r\n                                <td class=\"TRNSPT\"onclick=\"openSubR('`+ Data[i].COD + `','` + Data[i].billDetails[j].ccd + `')\">` + (Data[i].billDetails[j].ccd) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (Data[i].billDetails[j].BLL) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (Data[i].billDetails[j].VNO) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + formatDate(Data[i].billDetails[j].BDT) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (Data[i].billDetails[j].CQN) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + formatDate(Data[i].billDetails[j].RDT) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (Data[i].billDetails[j].PDA) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (BA) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (CL) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (Data[i].billDetails[j].RDT) + `</td>\r\n                                <td onclick=\"openSubR('`+ Data[i].COD + `')\">` + (Data[i].billDetails[j].CMA) + `</td>             \r\n                                </tr>`;\r\n\r\n\r\n              if (j == BLL - 1) {\r\n\r\n                tr += `  \r\n            <tr class=\"tfootcard\"style=\"background-color:#3e3b3b26;color:#c107a2;text-align: center;\">\r\n            <td class=\"hideAbleTr\" colspan=\"6\">SUBTOTAL</td>\r\n            <td class=\"unhideAbleTr\" colspan=\"6\"onclick=\"openSubR('`+ Data[i].COD + `','` + Data[i].billDetails[j].ccd + `')\">` + Data[i].billDetails[j].ccd + `</td>\r\n             <td>`+ subtotalPDA + `</td>\r\n            <td>`+ subtotalBA + `</td>\r\n            <td>`+ subtotalCL + `</td>\r\n            <td colspan=\"1\"></td>\r\n            <td>`+ subtotalCMA + `</td>\r\n            </tr>  `;\r\n\r\n\r\n                totalPDA += subtotalPDA;\r\n                totalBA += subtotalBA;\r\n                totalCL += subtotalCL;\r\n                totalCMA += subtotalCMA;\r\n                subtotalPDA = 0;\r\n                subtotalBA = 0;\r\n                subtotalCL = 0;\r\n                subtotalCMA = 0;\r\n\r\n              }\r\n            }\r\n\r\n            grandtotalPDA += totalPDA;\r\n            grandtotalBA += totalBA;\r\n            grandtotalCL += totalCL;\r\n            grandtotalCMA += totalCMA;\r\n\r\n            tr += `<tr class=\"tfootcard\"style=\"background-color:#3e3b3b26;\">\r\n                <td  colspan=\"6\">TOTAL</td>\r\n                <td>`+ totalPDA + `</td>\r\n                <td>`+ totalBA + `</td>\r\n                <td>`+ totalCL + `</td>\r\n                <td colspan=\"1\"></td>\r\n                <td>`+ totalCMA + `</td>\r\n                                </tr>`;\r\n            totalPDA = 0;\r\n            totalBA = 0;\r\n            totalCL = 0;\r\n            totalCMA = 0;\r\n          }\r\n\r\n        }\r\n        tr += `<tr class=\"tfootcard\"style=\"background-color:#3e3b3b26;color:#080844;\">\r\n    <td  colspan=\"6\">GRAND TOTAL</td>\r\n    <td>`+ grandtotalPDA + `</td>\r\n    <td>`+ grandtotalBA + `</td>\r\n    <td>`+ grandtotalCL + `</td>\r\n    <td colspan=\"1\"></td>\r\n    <td>`+ grandtotalCMA + `</td>\r\n    </tr>`;\r\n\r\n        $('#result').html(tr);\r\n        $(\"#loader\").removeClass('has-loader');\r\n\r\n        var hideAbleTr = getUrlParams(url, \"hideAbleTr\");\r\n        if (hideAbleTr == \"true\") {\r\n          $('.hideAbleTr').css(\"display\", \"none\");\r\n          $('.unhideAbleTr').css(\"display\", \"\");\r\n        } else {\r\n          $('.unhideAbleTr').css(\"display\", \"none\");\r\n        }\r\n\r\n        AddHeaderTbl();\r\n      } else {\r\n        $('#result').html('<h1>No Data Found</h1>');\r\n        $(\"#loader\").removeClass('has-loader');\r\n      }\r\n\r\n    } catch (e) {\r\n      var shareText = \"Error in : \" + e;\r\n      $('#result').html(`<h5>error:` + e + `<br> please send this error screen shot to whatsApp No. <a href=\"https://wa.me/918469190530?text=` + encodeURIComponent(shareText) + `\">8469190530</a></h5>`);\r\n      $(\"#loader\").removeClass('has-loader');\r\n    }\r\n  }\r\n  loadCalljsLoaded = true;\r\n\r\n  var my_awesome_script = document.createElement('script');\r\n  my_awesome_script.setAttribute('src', 'js/jsPopUpModelParty.js');\r\n  document.head.appendChild(my_awesome_script);\r\n\r\n</script>\r\n<script src=\"js/jsgetValueNotDefine.js\"></script>\r\n<script>\r\n\r\n  var url = window.location.href;\r\n  var pdfStatus = false;\r\n  var Data;\r\n  var PAID = 'N';\r\n  var ATYPE = '1';\r\n  var tr = '';\r\n  var FIRM = getUrlParams(url, \"FIRM\");\r\n  var cno = '';\r\n  var EMP;\r\n  var partyname = getUrlParams(url, \"partyname\");\r\n  var partycode = getUrlParams(url, \"partycode\");\r\n  var ccd = getUrlParams(url, \"ccd\");\r\n  var ccdcode = getUrlParams(url, \"ccdcode\");\r\n  if (ccd == '') {\r\n    ccdcode = '';\r\n  }\r\n  if (partyname == '') {\r\n    partycode = '';\r\n  }\r\n  var broker = getUrlParams(url, \"broker\");\r\n  var CITY = getUrlParams(url, \"city\");\r\n  var haste = getUrlParams(url, \"haste\");\r\n  var fromdate = getUrlParams(url, \"search_FromDate\");\r\n  var todate = getUrlParams(url, \"search_ToDate\");\r\n  var DAYSCONDITION = getUrlParams(url, \"DAYSCONDITION\");\r\n  GRD = getUrlParams(url, \"GRD\");\r\n  var DataCompmst = JSON.parse(localStorage.getItem(\"COMPMST\"));\r\n  var nowDate = new Date();\r\n  if (FIRM != '') {\r\n    for (var i = 0; i < DataCompmst.length; i++) {\r\n      if (DataCompmst[i].FIRM == FIRM) {\r\n        cno = DataCompmst[i].CNO;\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<script>\r\n  document.title = \"COMM. REPORT \" + partyname + \" \" + broker + \" \" + CITY;\r\n  $(document).ready(function () {\r\n    $(\"#loader\").addClass('has-loader');\r\n    load_data();\r\n  });\r\n\r\n  function load_data() {\r\n    jsGetObjectByKey(DSN, \"MST\", \"\").then(function (data) {\r\n      masterData = data;\r\n      jsGetObjectByKey(DSN, \"COMM\", \"\").then(function (data) {\r\n        Data = data;\r\n        loadCall(Data);\r\n      });\r\n    })\r\n  }\r\n\r\n</script>\r\n<script src=\"js/jsHeaderTbl.js\"></script>"
        }
    ]
}