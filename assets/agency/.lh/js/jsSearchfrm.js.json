{
    "sourceFile": "js/jsSearchfrm.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1637469103127,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1637469251147,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,11 +64,14 @@\n             } catch (error) {\n \n             }\n             //----------------broker-------------------\n+            console.log(brokerArray);\n+\n             brokerArray = brokerArray.filter(function (data) {\n                 return data.ATYPE == 12;\n             })\n+            console.log(brokerArray);\n             $(\"#broker\").keyup(function (e) {\n                 if (e.which == 38 || e.which == 40 || e.which == 13) {\n                     return;\n                 } else {\n"
                },
                {
                    "date": 1637472354860,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -83,9 +83,10 @@\n                             minLength: 1,\n                             source: brokerArray,\n                             select: function (event, ui) {\n                                 event.preventDefault();\n-                                $(\"#broker\").val(ui.item.value);\n+                                $(\"#broker\").val(ui.item.partyname);\n+                                $(\"#brokercode\").val(ui.item.value);\n                             },\n                         });\n                     }\n                 }\n"
                }
            ],
            "date": 1637469103127,
            "name": "Commit-0",
            "content": "var masterData;\nvar ReportTypeArray;\nvar url = window.location.href;\nvar acgroupData;\nvar partynameAcgroupData;\nvar ccdAcgroupData;\nfunction clearMobileNo() {\n    $('#mobileNo').val('')\n}\n$(document).ready(function () {\n    $(\"#partyname\").focus(function () {\n        clearMobileNo();\n    });\n    $(\"#ccd\").focus(function () {\n        clearMobileNo();\n    });\n\n    jsGetObjectByKey(DSN, \"ACGROUP\", \"\").then(function (data) {\n        acgroupData = data;\n        console.log(acgroupData)\n        partynameAcgroupData = acgroupData.filter(function (d) {\n            return d.ATYPE == 1;\n        })\n        ccdAcgroupData = acgroupData.filter(function (d) {\n            return d.ATYPE == 2;\n        })\n        jsGetObjectByKey(DSN, \"MST\", \"\").then(function (data) {\n            masterData = data;\n            ccdmasterData = data;\n            if (url.indexOf('ALLSALE_FRMReport') > -1 || url.indexOf('DDREG_FRMReport') > -1 || url.indexOf('COMM_FRMReport') > -1 || (url.indexOf('OUTSTANDING_FRMReport') > -1 && url.indexOf('PURCHASEOUTSTANDING_FRMReport') < 0)) {\n                masterData = masterData.filter(function (data) {\n                    return data.ATYPE == 1;\n                })\n                ccdmasterData = ccdmasterData.filter(function (data) {\n                    return data.ATYPE == 2;\n                })\n            } else if (url.indexOf('PURCHASEOUTSTANDING_FRMReport') > -1 || url.indexOf('PURCHASE_FRMReport') > -1 || url.indexOf('PURCHASEFINISH_FRMReport') > -1) {\n                masterData = masterData.filter(function (data) {\n                    return data.ATYPE != 1;\n                })\n                ccdmasterData = ccdmasterData.filter(function (data) {\n                    return data.ATYPE == 2;\n                })\n            }\n            var brokerArray = data;\n            var array = data;\n            var unique = [];\n            var distinct = [];\n            try {\n\n                for (let i = 0; i < array.length; i++) {\n                    if (!unique[array[i].PTGD]) {\n                        distinct.push(array[i].PTGD);\n                        unique[array[i].PTGD] = 1;\n                        if (array[i].PTGD != null) {\n                            getoption(array[i].PTGD, array[i].PTGD, \"GRD\");\n                            document.getElementById(\"GRD\").value = \"GRADE\";\n                        }\n\n                    }\n                }\n                getoption(\"GRADE\", \"\", \"GRD\");\n\n            } catch (error) {\n\n            }\n            //----------------broker-------------------\n            brokerArray = brokerArray.filter(function (data) {\n                return data.ATYPE == 12;\n            })\n            $(\"#broker\").keyup(function (e) {\n                if (e.which == 38 || e.which == 40 || e.which == 13) {\n                    return;\n                } else {\n                    var broker = $(this).val();\n                    //alert(broker);\n                    if (broker != \"\") {\n                        console.log(\"----\" + broker);\n                        $(\"#broker\").autocomplete({\n                            minLength: 1,\n                            source: brokerArray,\n                            select: function (event, ui) {\n                                event.preventDefault();\n                                $(\"#broker\").val(ui.item.value);\n                            },\n                        });\n                    }\n                }\n            });\n            //----------------------\n            $(\"#partyname\").keyup(function (e) {\n                if (e.which == 38 || e.which == 40 || e.which == 13) {\n                    return;\n                } else {\n                    var partyname = $(this).val();\n                    //alert(partyname);\n                    if (partyname !== \"\") {\n                        if (masterData.length > 0) {\n                            console.log(\"----\" + partyname);\n                            $(\"#partyname\").autocomplete({\n                                minLength: 1,\n                                source: function (request, response) {\n                                    var term = $.ui.autocomplete.escapeRegex(\n                                        request.term\n                                    ),\n                                        startsWithMatcher = new RegExp(\"^\" + term, \"i\"),\n                                        startsWith = $.grep(masterData, function (\n                                            value\n                                        ) {\n                                            return startsWithMatcher.test(\n                                                value.label || value.partyname || value\n                                            );\n                                        }),\n                                        containsMatcher = new RegExp(term, \"i\"),\n                                        contains = $.grep(masterData, function (value) {\n                                            return (\n                                                $.inArray(value, startsWith) < 0 &&\n                                                containsMatcher.test(\n                                                    value.label || value.partyname || value\n                                                )\n                                            );\n                                        });\n\n                                    response(startsWith.concat(contains));\n                                },\n                                select: function (event, ui) {\n                                    event.preventDefault();\n                                    $(this).val(ui.item.label);\n                                    $(\"#partycode\").val(ui.item.value);\n                                    $(\"#partyname\").val(ui.item.partyname);\n                                    try {\n                                        $(\"#mobileNo\").val(ui.item.MO);\n                                    } catch (error) {\n\n                                    }\n                                },\n                            });\n                        }\n                    }\n                }\n            });\n            //----------------------\n            $(\"#partynamegrp\").keyup(function (e) {\n                if (e.which == 38 || e.which == 40 || e.which == 13) {\n                    return;\n                } else {\n                    var partynamegrp = $(this).val();\n                    //alert(partynamegrp);\n                    if (partynamegrp !== \"\") {\n                        if (partynameAcgroupData.length > 0) {\n                            console.log(\"----\" + partynamegrp);\n                            $(\"#partynamegrp\").autocomplete({\n                                minLength: 1,\n                                source: function (request, response) {\n                                    var term = $.ui.autocomplete.escapeRegex(\n                                        request.term\n                                    ),\n                                        startsWithMatcher = new RegExp(\"^\" + term, \"i\"),\n                                        startsWith = $.grep(partynameAcgroupData, function (\n                                            value\n                                        ) {\n                                            return startsWithMatcher.test(\n                                                value.label || value.partyname || value\n                                            );\n                                        }),\n                                        containsMatcher = new RegExp(term, \"i\"),\n                                        contains = $.grep(partynameAcgroupData, function (value) {\n                                            return (\n                                                $.inArray(value, startsWith) < 0 &&\n                                                containsMatcher.test(\n                                                    value.label || value.partyname || value\n                                                )\n                                            );\n                                        });\n\n                                    response(startsWith.concat(contains));\n                                },\n                                select: function (event, ui) {\n                                    event.preventDefault();\n                                    $(this).val(ui.item.label);\n                                    $(\"#partycodegrp\").val(ui.item.value);\n                                    $(\"#partynamegrp\").val(ui.item.partyname);\n                                    try {\n                                        $(\"#mobileNo\").val(ui.item.MO);\n                                    } catch (error) {\n\n                                    }\n                                },\n                            });\n                        }\n                    }\n                }\n            });\n\n            $(\"#ccd\").keyup(function (e) {\n                if (e.which == 38 || e.which == 40 || e.which == 13) {\n                    return;\n                } else {\n                    var ccd = $(this).val();\n                    //alert(ccd);\n                    if (ccd !== \"\") {\n                        if (ccdmasterData.length > 0) {\n                            console.log(\"----\" + ccd);\n                            $(\"#ccd\").autocomplete({\n                                minLength: 1,\n                                source: function (request, response) {\n                                    var term = $.ui.autocomplete.escapeRegex(\n                                        request.term\n                                    ),\n                                        startsWithMatcher = new RegExp(\"^\" + term, \"i\"),\n                                        startsWith = $.grep(ccdmasterData, function (\n                                            value\n                                        ) {\n                                            return startsWithMatcher.test(\n                                                value.label || value.ccd || value\n                                            );\n                                        }),\n                                        containsMatcher = new RegExp(term, \"i\"),\n                                        contains = $.grep(ccdmasterData, function (value) {\n                                            return (\n                                                $.inArray(value, startsWith) < 0 &&\n                                                containsMatcher.test(\n                                                    value.label || value.ccd || value\n                                                )\n                                            );\n                                        });\n\n                                    response(startsWith.concat(contains));\n                                },\n                                select: function (event, ui) {\n                                    event.preventDefault();\n                                    $(this).val(ui.item.label);\n                                    $(\"#ccd\").val(ui.item.partyname);\n                                    $(\"#ccdcode\").val(ui.item.value);\n                                    try {\n                                        $(\"#mobileNo\").val(ui.item.MO);\n                                    } catch (error) {\n\n                                    }\n                                },\n                            });\n                        }\n                    }\n                }\n            });\n\n            $(\"#ccdgrp\").keyup(function (e) {\n                if (e.which == 38 || e.which == 40 || e.which == 13) {\n                    return;\n                } else {\n                    var ccdgrp = $(this).val();\n                    //alert(ccdgrp);\n                    if (ccdgrp !== \"\") {\n                        if (ccdAcgroupData.length > 0) {\n                            console.log(\"----\" + ccdgrp);\n                            $(\"#ccdgrp\").autocomplete({\n                                minLength: 1,\n                                source: function (request, response) {\n                                    var term = $.ui.autocomplete.escapeRegex(\n                                        request.term\n                                    ),\n                                        startsWithMatcher = new RegExp(\"^\" + term, \"i\"),\n                                        startsWith = $.grep(ccdAcgroupData, function (\n                                            value\n                                        ) {\n                                            return startsWithMatcher.test(\n                                                value.label || value.ccd || value\n                                            );\n                                        }),\n                                        containsMatcher = new RegExp(term, \"i\"),\n                                        contains = $.grep(ccdAcgroupData, function (value) {\n                                            return (\n                                                $.inArray(value, startsWith) < 0 &&\n                                                containsMatcher.test(\n                                                    value.label || value.ccd || value\n                                                )\n                                            );\n                                        });\n\n                                    response(startsWith.concat(contains));\n                                },\n                                select: function (event, ui) {\n                                    event.preventDefault();\n                                    $(this).val(ui.item.label);\n                                    $(\"#ccdgrp\").val(ui.item.partyname);\n                                    $(\"#ccdcodegrp\").val(ui.item.value);\n                                    try {\n                                        $(\"#mobileNo\").val(ui.item.MO);\n                                    } catch (error) {\n\n                                    }\n                                },\n                            });\n                        }\n                    }\n                }\n            });\n        })\n    })\n\n    var cityArray\n    jsGetObjectByKey(DSN, \"CITY\", \"\").then(function (data) {\n        cityArray = data.map(function (data) {\n            return {\n                label: data.CT\n            }\n        });\n\n        $(\"#city\").keyup(function (e) {\n            if (e.which == 38 || e.which == 40 || e.which == 13) {\n                return;\n            } else {\n                var city = $(this).val();\n                //alert(city);\n                if (city != \"\") {\n                    console.log(\"--\" + city);\n                    $(\"#city\").autocomplete({\n                        minLength: 1,\n                        source: cityArray\n                    });\n                }\n            }\n        });\n    });\n\n\n\n\n    jsGetObjectByKey(DSN, \"HASTE\", \"\").then(function (data) {\n        var hasteArray = data.map(function (data) {\n            return {\n                label: data.HS\n            }\n        });\n        $(\"#haste\").keyup(function (e) {\n            if (e.which == 38 || e.which == 40 || e.which == 13) {\n                return;\n            } else {\n                var haste = $(this).val();\n                //alert(haste);\n                if (haste !== \"\") {\n                    console.log(\"----\" + haste);\n                    $(\"#haste\").autocomplete({\n                        minLength: 1,\n                        source: hasteArray\n                    });\n                }\n            }\n        });\n    });\n\n    jsGetObjectByKey(DSN, \"SERIES\", \"\").then(function (data) {\n        ReportTypeArray = data.map(function (data) {\n            return {\n                label: data.SERIES,\n                value: data.ST,\n                TYPE: data.SERIESCODE,\n                DT: data.DT\n            }\n        });\n\n        if (url.indexOf('PURCHASEFINISH_FRMReport') > -1) {\n            document.getElementById('ReportType').value = \"\"\n            document.getElementById('ReportATypeCode').value = \"\"\n            document.getElementById('ReportSeriesTypeCode').value = \"P\"\n        } else if (url.indexOf('RETURNGOODS_FRMReport') > -1) {\n            document.getElementById('ReportType').value = \"\"\n            document.getElementById('ReportATypeCode').value = \"1\"\n            document.getElementById('ReportSeriesTypeCode').value = \"P\"\n            document.getElementById('ReportDOC_TYPECode').value = \"CN\"\n        } else if (url.indexOf('PURCHASE_FRMReport') > -1) {\n            var TYPE = \"P1\"\n            var seriesArray = getReportTypeArrayBySERIES(TYPE);\n            document.getElementById('ReportType').value = seriesArray[0].label\n            document.getElementById('ReportATypeCode').value = seriesArray[0].value\n            document.getElementById('ReportSeriesTypeCode').value = TYPE\n        } else if (url.indexOf('PURCHASEOUTSTANDING_FRMReport') > -1) {\n            var TYPE = \"P1\"\n            var seriesArray = getReportTypeArrayBySERIES(TYPE);\n            document.getElementById('ReportType').value = seriesArray[0].label\n            document.getElementById('ReportATypeCode').value = seriesArray[0].value\n            document.getElementById('ReportSeriesTypeCode').value = TYPE\n            console.log(seriesArray)\n        } else if (url.indexOf('COMM_FRMReport') > -1) {\n            document.getElementById('ReportType').value = \"COMMISSION PENDING\"\n            document.getElementById('ReportATypeCode').value = \"2\"\n            document.getElementById('ReportSeriesTypeCode').value = \"\"\n        } else if (url.indexOf('DDREG_FRMReport') > -1) {\n            document.getElementById('ReportType').value = \"DD REGISTER\"\n            document.getElementById('ReportATypeCode').value = \"2\"\n            document.getElementById('ReportSeriesTypeCode').value = \"\"\n        } else {\n            try {\n                var TYPE = \"S1\"\n                var seriesArray = getReportTypeArrayBySERIES(TYPE);\n                document.getElementById('ReportType').value = seriesArray[0].label\n                document.getElementById('ReportATypeCode').value = seriesArray[0].value\n                document.getElementById('ReportSeriesTypeCode').value = TYPE\n            } catch (error) {\n\n            }\n        }\n        $(\"#ReportType\").keyup(function (e) {\n            if (e.which == 38 || e.which == 40 || e.which == 13) {\n                return;\n            } else {\n                var ReportType = $(this).val();\n                //alert(ReportType);\n                if (ReportType !== \"\") {\n                    console.log(\"----\" + ReportType);\n                    $(\"#ReportType\").autocomplete({\n                        minLength: 1,\n                        source: function (request, response) {\n                            var term = $.ui.autocomplete.escapeRegex(request.term),\n                                startsWithMatcher = new RegExp(\"^\" + term, \"i\"),\n                                startsWith = $.grep(ReportTypeArray, function (value) {\n                                    return startsWithMatcher.test(value.label || value.SERIESCODE || value);\n                                }),\n                                containsMatcher = new RegExp(term, \"i\"),\n                                contains = $.grep(ReportTypeArray, function (value) {\n                                    return ($.inArray(value, startsWith) < 0 && containsMatcher.test(value.label || value.SERIESCODE || value)\n                                    );\n                                });\n\n                            response(startsWith.concat(contains));\n                        },\n                        select: function (event, ui) {\n                            event.preventDefault();\n                            $(this).val(ui.item.label);\n                            $(\"#ReportType\").val(ui.item.label);\n                            $(\"#ReportATypeCode\").val(ui.item.value);\n                            $(\"#ReportSeriesTypeCode\").val(ui.item.TYPE);\n                            $(\"#ReportDOC_TYPECode\").val(ui.item.DT);\n                            console.log(ui.item.label, ui.item.value, ui.item.TYPE, ui.item.DT);\n                        },\n                    });\n                }\n            }\n        });\n    });\n\n\n\n});\n\nfunction getReportTypeArrayBySERIES(code) {\n    return ReportTypeArray.filter(function (d) {\n        return d.TYPE == code;\n    })\n}"
        }
    ]
}